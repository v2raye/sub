mixed-port: 7890
socks-port: 7891
ipv6: true
mode: rule
log-level: warning
allow-lan: true
unified-delay: true
tcp-concurrent: true
find-process-mode: strict
global-client-fingerprint: chrome

profile:
  store-selected: true
  store-fake-ip: true

sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]

tun:
  enable: true
  stack: gvisor   # å®‰å“æ›´æ¨è gvisor
  dns-hijack:
    - any:53
  auto-route: true
  auto-redirect: true
  auto-detect-interface: true

dns:
  enable: true
  listen: 127.0.0.1:5450
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-filter:
    - "*.lan"
    - "*.local"
    - "*.cn"
    - "*.168.192.in-addr.arpa"
    - "*.10.in-addr.arpa"
    - "*.100.in-addr.arpa"
    - "*.1.in-addr.arpa"
    - "stun.*"
    - "stun.*.*"
    - "time.*"
    - "ntp.*"
    - "localhost"
    - "*.pool.ntp.org"
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
    - system
  nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query

proxy-providers: 
  æˆ‘çš„èŠ‚ç‚¹:
    url: ""   # åœ¨è¿™é‡Œå¡«ä½ çš„è®¢é˜…åœ°å€
    path: ./proxy_provider/Providers.yaml
    type: http
    interval: 86400
    health-check:
      enable: true
      url: http://captive.apple.com/generate_204
      interval: 60

# èŠ‚ç‚¹ç­›é€‰æ­£åˆ™ï¼ˆä¼˜åŒ–åï¼‰
FilterHK: &FilterHK '(?i)(ğŸ‡­ğŸ‡°|é¦™æ¸¯|HK|Hong)'
FilterJP: &FilterJP '(?i)(ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|ä¸œäº¬|å¤§é˜ª|JP|Japan)'
FilterSG: &FilterSG '(?i)(ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|SG|Singapore)'
FilterUS: &FilterUS '(?i)(ğŸ‡ºğŸ‡¸|ç¾å›½|US|United States|æ´›æ‰çŸ¶|ç¡…è°·)'
FilterTW: &FilterTW '(?i)(ğŸ‡¹ğŸ‡¼|å°æ¹¾|TW|Taiwan)'
FilterEU: &FilterEU '(?i)(ğŸ‡¬ğŸ‡§|UK|è‹±å›½|ğŸ‡©ğŸ‡ª|DE|å¾·å›½|ğŸ‡«ğŸ‡·|FR|æ³•å›½|ğŸ‡³ğŸ‡±|NL|è·å…°|ğŸ‡®ğŸ‡¹|IT|æ„å¤§åˆ©|ğŸ‡ªğŸ‡¸|ES|è¥¿ç­ç‰™|ğŸ‡¨ğŸ‡­|CH|ç‘å£«|ğŸ‡¸ğŸ‡ª|SE|ç‘å…¸|ğŸ‡³ğŸ‡´|NO|æŒªå¨|ğŸ‡µğŸ‡±|PL|æ³¢å…°|ğŸ‡«ğŸ‡®|FI|èŠ¬å…°)'
FilterEM: &FilterEM '^(?=.*DlerCloud)(?=.*(ğŸ‡­ğŸ‡°|HK|Hong|ğŸ‡ºğŸ‡¸|US|United States))'
Select: &Select {type: select, include-all: true}
proxy-groups:
  - {name: Outside,  type: select, proxies: [é¦™æ¸¯èŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, æ–°åŠ å¡èŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, æ¬§ç›ŸèŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, DIRECT]}
  - {name: YouTube,  type: select, proxies: [é¦™æ¸¯èŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, æ–°åŠ å¡èŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, æ¬§ç›ŸèŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹]}
  - {name: Google,   type: select, proxies: [é¦™æ¸¯èŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, æ–°åŠ å¡èŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, æ¬§ç›ŸèŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹]}
  - {name: OpenAI,   type: select, proxies: [é¦™æ¸¯èŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, æ–°åŠ å¡èŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, æ¬§ç›ŸèŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹]}
  - {name: Samsung,  type: select, proxies: [é¦™æ¸¯èŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, æ–°åŠ å¡èŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, æ¬§ç›ŸèŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, DIRECT]}
  - {name: Telegram, type: select, proxies: [é¦™æ¸¯èŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, æ–°åŠ å¡èŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, æ¬§ç›ŸèŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹]}
  - {name: Emby,     type: select, proxies: [EMèŠ‚ç‚¹, DIRECT]}
  - {name: Emby, type: select, proxies: [EMèŠ‚ç‚¹,DIRECT]} 
  - {name: é¦™æ¸¯èŠ‚ç‚¹, <<: *Select, filter: *FilterHK} 
  - {name: å°æ¹¾èŠ‚ç‚¹, <<: *Select, filter: *FilterTW} 
  - {name: æ—¥æœ¬èŠ‚ç‚¹, <<: *Select, filter: *FilterJP} 
  - {name: æ–°åŠ å¡èŠ‚ç‚¹, <<: *Select, filter: *FilterSG} 
  - {name: ç¾å›½èŠ‚ç‚¹, <<: *Select, filter: *FilterUS} 
  - {name: æ¬§ç›ŸèŠ‚ç‚¹, <<: *Select, filter: *FilterEU} 
  - {name: EMèŠ‚ç‚¹, <<: *Select, filter: *FilterEM}

rules:
  - DOMAIN,local.adguard.org,REJECT
  - OR,((DOMAIN,media.micu.hk),(DOMAIN,rfc.uhdnow.com),(DOMAIN,cf.bili.rip),(DOMAIN,emby.as174.de)),Emby
  - DOMAIN,injections.adguard.org,Outside
  - RULE-SET,Private_domain,DIRECT
  - RULE-SET,OpenAI,OpenAI
  - RULE-SET,Google_domain,Google
  - RULE-SET,Samsung_domain,Samsung
  - RULE-SET,Telegram,Telegram
  - RULE-SET,CN_domain,DIRECT
  - RULE-SET,Proxy,Outside
  - RULE-SET,Private_ip,DIRECT,no-resolve
  - RULE-SET,Google_ip,Google
  - RULE-SET,CN_ip,DIRECT
  - MATCH,Outside

rule-anchor:
  ip: &ip {type: http, interval: 43200, behavior: ipcidr, format: mrs}
  domain: &domain {type: http, interval: 43200, behavior: domain, format: mrs}

rule-providers:
  Private_domain: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/private.mrs"}
  CN_domain: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/cn.mrs"}
  Samsung_domain: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/samsung.mrs"}
  OpenAI: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/openai.mrs"}
  Google_domain: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/google.mrs"}
  Telegram: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo-lite/geosite/telegram.mrs"}
  Proxy: {<<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/geolocation-!cn.mrs"}

  Private_ip: {<<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geoip/private.mrs"}
  CN_ip: {<<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geoip/cn.mrs"}
  Google_ip: {<<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geoip/google.mrs"}
